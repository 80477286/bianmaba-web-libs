(function(r,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("axios"),require("element-plus"),require("vue")):typeof define=="function"&&define.amd?define(["exports","axios","element-plus","vue"],i):(r=typeof globalThis<"u"?globalThis:r||self,i(r.index={},r.Axios,r.ElementPlus,r.Vue))})(this,function(r,i,o,g){"use strict";var I=Object.defineProperty;var b=(r,i,o)=>i in r?I(r,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[i]=o;var u=(r,i,o)=>(b(r,typeof i!="symbol"?i+"":i,o),o);const S=Object.prototype.toString,w=function(s){return function(e){let t=S.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())}}(Object.create(null)),O=s=>{if(w(s)!=="object")return!1;let e=Object.getPrototypeOf(s);return e===null||e===Object.prototype},E=s=>Array.isArray(s),A=(s,e)=>{if(!(s===null||typeof s>"u"))if(typeof s!="object"&&(s=[s]),E(s))for(let t=0,a=s.length;t<a;t++)e.call(null,s[t],t,s);else for(let t in s)Object.prototype.hasOwnProperty.call(s,t)&&e.call(null,s[t],t,s)},l=function(...s){let e={},t=(a,n)=>{O(e[n])&&O(a)?e[n]=l(e[n],a):O(a)?e[n]=l({},a):E(a)?e[n]=a.slice():e[n]=a};for(let a=0,n=s.length;a<n;a++)A(s[a],t);return e};var h=(s=>(s["application/atom+xml"]="application/atom+xml",s["application/json"]="application/json",s["application/x-www-form-urlencoded"]="application/x-www-form-urlencoded",s["application/xml"]="application/xml",s["multipart/form-data"]="multipart/form-data",s["text/html"]="text/html",s["text/plain"]="text/plain",s))(h||{}),d=(s=>(s.POST="POST",s.GET="GET",s.DELETE="DELETE",s.HEAD="HEAD",s.OPTIONS="OPTIONS",s.PUT="PUT",s.PATCH="PATCH",s.PURGE="PURGE",s.LINK="LINK",s.UNLINK="UNLINK",s))(d||{});const p={method:d.POST,headers:{"Content-Type":h["application/json"]},xRequestedWith:"XMLHttpRequest"};class P{constructor(e=p){u(this,"globalOptions",p);this.globalOptions=l(this.globalOptions,e),console.debug("初始化全局配置..."),i.defaults.baseURL=this.globalOptions.baseUrl,i.defaults.method=this.globalOptions.method,i.defaults.headers.common["X-Requested-With"]=this.globalOptions.xRequestedWith,i.interceptors.request.use(this.globalOptions.requestSuccessHandler||this.defaultRequestSuccessHandler,this.globalOptions.requestFailHandler||this.defaultRequestFailHandler),i.interceptors.response.use(this.globalOptions.responseSuccessHandler||this.defaultResponseSuccessHandler,this.globalOptions.responseFailHandler||this.defaultResponseFailHandler),console.debug("全局配置初始化完成。")}defaultRequestSuccessHandler(e){return e}defaultRequestFailHandler(e){return o.ElNotification.error({title:"错误",message:"远程请求出现错误：",offset:120,duration:2e3}),Promise.reject(e)}defaultResponseSuccessHandler(e){return e}defaultResponseFailHandler(e){var t,a;return o.ElNotification.error({title:"错误",dangerouslyUseHTMLString:!0,message:((a=(t=e.response)==null?void 0:t.data)==null?void 0:a.result)||"远程请求出现错误(code="+e.response.status+")",offset:120,duration:2e3}),Promise.reject(e)}createAxiosInstance(e){let t=i.create(e);return t.interceptors.request.use(this.globalOptions.requestSuccessHandler,this.globalOptions.requestFailHandler),t.interceptors.response.use(this.globalOptions.responseSuccessHandler,this.globalOptions.responseFailHandler),t}}class f{constructor(e,t){u(this,"instance");u(this,"url","");u(this,"loading",!1);u(this,"response",{success:!1});u(this,"data",{});u(this,"params",{});this.instance=e,this.url=t||""}execute(e={}){return this.loading=!0,this.data=l(this.data||{},e.data||{}),this.params=l(this.params||{},e.params||{}),e.url=e.url?e.url:this.url,new Promise((t,a)=>{this.instance.request(e).then(n=>{this.handleThenResponse(t,n)}).catch(n=>{this.handleCatchResponse(a,n)}).finally(()=>{this.loading=!1})})}setDefaultResponse(e={}){return this.response=l(this.response,e),this}setDefaultRequestData(e={}){return this.data=l(this.data,e),this}setDefaultResultParams(e={}){return this.params=l(this.params,e),this}handleThenResponse(e,t){this.response=t.data,e(t.data)}handleCatchResponse(e,t){if(console.error("远程请求发生异常：",t),t.response)this.response=t.response.data,e(t.response.data);else{let a={success:!1,result:"远程请求发生异常！",data:null};this.response=a,e(a)}}}class T extends f{constructor(e,t){super(e,t)}execute(e={},t={}){return this.loading=!0,this.params=l(this.params||{},t.params||{},e||{}),t.params=this.params,new Promise((a,n)=>{this.instance.get(t.url||this.url,t).then(c=>{this.handleThenResponse(a,c)}).catch(c=>{this.handleCatchResponse(n,c)}).finally(()=>{this.loading=!1})})}}class q extends f{constructor(e,t){super(e,t)}execute(e={},t={},a={}){return this.loading=!0,this.data=l(this.data||{},a.data||{},e||{}),this.params=l(this.params||{},a.params||{},t||{}),this.setDefaultResponse({total:0,page:1,size:10}),a.params=this.params,new Promise((n,c)=>{this.instance.post(a.url||this.url,this.data,a).then(R=>{this.handleThenResponse(n,R)}).catch(R=>{this.handleCatchResponse(c,R)}).finally(()=>{this.loading=!1})})}}const x=class extends P{constructor(e=p){super(e)}createRequestExecutor(e="",t={}){let a=this.createAxiosInstance(t);return g.reactive(new f(a,e))}createGetExecutor(e="",t={}){let a=l({method:d.GET,data:null,params:null,headers:{"Content-Type":h["application/x-www-form-urlencoded"]}},t),n=this.createAxiosInstance(a);return g.reactive(new T(n,e))}createPostExecutor(e="",t={}){let a=l({method:d.POST,data:null,params:null,headers:{"Content-Type":h["multipart/form-data"]}},t),n=this.createAxiosInstance(a);return g.reactive(new q(n,e))}static getInstance(){return this.getInstance()}static getInstance(e){return this.instance?e&&console.error("实例已经存在，重获取实例时，配置选项将不会生效！"):this.instance=new x(l(p,e||{})),this.instance}};let m=x;u(m,"instance"),r.AbstractAxiosHelper=P,r.AxiosHelper=m,r.Executor=f,r.GetExecutor=T,r.PostExecutor=q,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
